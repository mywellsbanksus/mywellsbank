"use strict";function isValidNumber(str){str+="";if(str.indexOf("-")>-1){return false;}return !isNaN(parseFloat(str.replace(/,/g,"")));}function addCommas(num){if(num){num=parseInt(num,10);num+="";return num.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");}else{return num;}}function setPatternToNumber(inputField){var inputField=$(inputField);if(inputField.val()!=""&&inputField.val().length>0){inputField.val(parseFloat($(inputField).val().replace(/[^0-9]/g,""))).attr("pattern","[0-9]*");}}function formatCurrency(num,considerzero){if(!considerzero||typeof(considerzero)=="undefined"){if(num==""&&num!=0){return;}}else{if(considerzero){if(num==""){if(!$("#debtCalculatorForm")){return 0;}}}}num=num+" ";num=num.replace(/[^0-9\-.]/g,"");if(num.indexOf("-")>-1){var arr=num.split("-");for(var i=0;i<arr.length;i++){arr[i]=addCommas(Math.round(arr[i]));}num=arr.join(" - ");}else{if(num!=""){num=Math.round(num);num=addCommas(num);}}return num;}var catchShiftFixIE=function(e){if(e.keyCode!==16){if(e.keyCode==36||e.keyCode==9||e.keyCode==37||e.keyCode==39||e.keyCode==8||e.keyCode==46||(e.keyCode>=48&&e.keyCode<=57)||e.keyCode==39||e.keyCode==37||(e.keyCode>=96&&e.keyCode<=105)){$(this).select();return true;}else{return false;}}};var initMainPageAfterLoad=function(){$(document).on("blur","#incomeBeforeTax, #monthlyDebtPayments",function(){$(this).val(formatCurrency(($(this).val()),true)).removeAttr("pattern").attr("maxlength","10");});$(document).on("focus","#incomeBeforeTax, #monthlyDebtPayments",function(){setPatternToNumber($(this));$(this).attr("maxlength","8");});$(document).on("focus",".otherField",function(){setPatternToNumber($(this));$(this).attr("maxlength","6");});$(document).on("blur",".otherField",function(){$(this).attr("maxlength","7").val(formatCurrency(($(this).val()),true)).removeAttr("pattern");});$(document).on("keyup ",".otherField",function(){if(this.value!=this.value.replace(/[^0-9]/g,"")){this.value=this.value.replace(/[^0-9]/g,"");}else{setTotalVal(($(this).val()));$(this).attr("maxlength","6").removeAttr("pattern");}});$(".currency").on("keyup",function(e){if(this.value!=this.value.replace(/[^0-9]/g,"")){this.value=this.value.replace(/[^0-9]/g,"");}});};$(document).ready(function(){initMainPageAfterLoad();if(("undefined"!==typeof dtiRatio&&dtiRatio!="")&&(("undefined"!==typeof dtiRange)&&dtiRange!="")){showNextStep(dtiRatio,dtiRange,dtiDebt,dtiIncome);}$(document).on("submit","#dtitInitialForm, #debtCalculatorForm",function(evt){var targetForm=$(evt.target);switch(targetForm.attr("id")){case"dtitInitialForm":var output=dtiCal(evt);if(output=="true"){return true;}else{return false;}break;case"debtCalculatorForm":if($("#monthlyDebtPayments").val()){var monthlyDebtPaymentsValue=$("#monthlyDebtPayments").val();$("#hiddenDebt").val(monthlyDebtPaymentsValue);}if($("#incomeBeforeTax").val()){var incomeBeforeTaxValue=$("#incomeBeforeTax").val();$("#hiddenIncome").val(incomeBeforeTaxValue);}return true;break;}return false;});$(document).on("keydown","input",(function(e){if(e.keyCode==13&&$(this).attr("type")=="text"){e.preventDefault();return false;}}));validate();$("#incomeBeforeTax, #monthlyDebtPayments").change(validate);$("#incomeBeforeTax, #monthlyDebtPayments").keyup(validate);});function dtiCal(event){var debtValue=$("#monthlyDebtPayments").val();debtValue=debtValue.replace(/\,/g,"");debtValue=parseInt(debtValue,10);var taxableAmount=$("#incomeBeforeTax").val();taxableAmount=taxableAmount.replace(/\,/g,"");taxableAmount=parseInt(taxableAmount,10);if(taxableAmount==0&&debtValue==0){event.preventDefault();$("#incomeBeforeTax").val("").addClass("errorTime");$("#monthlyDebtPayments").val("").addClass("errorTime");$(".calcInputLabel").addClass("errorLabel");showMessageBox("error",errorZeroIncomeDebt);$("input[type=submit]").prop("disabled",true);return"false";}else{return"true";}}function validate(){if($("#incomeBeforeTax").val()&&$("#monthlyDebtPayments").val()){$("input[type=submit]").prop("disabled",false);}else{$("input[type=submit]").prop("disabled",true);}}function slideTo(num){var body=$("html, body");body.stop().animate({scrollTop:num},"500","swing");}function showNextStep(roundedValue,range,dtiDebt,dtiIncome){$("#dtiResults").removeClass("hide").addClass("show").attr("aria-hidden","false").trigger("showHideDtiContent");$(".dtiRatio h3").attr("tabindex","-1").focus();$("#nextSteps").removeClass("hide").addClass("show").attr("aria-hidden","false");var dtiWrapper=$(".dti-wrapper");var dtiData=dtiWrapper.data();dtiWrapper.data().totalIncome=Math.round(Number(dtiIncome.replace(new RegExp("(,)","g"),""))/12);dtiWrapper.data().totalDebt=Number(dtiDebt.replace(new RegExp("(,)","g"),""));if($(".dti-graph-holder").length===0){dtiWrapper.empty().on("showHideDtiContent",function(){}).generateDTIGraph({updateState:function(n){var c=dtiData.contentOpt1;if(n>35){c=dtiData.contentOpt2;}if(n>49){c=dtiData.contentOpt3;}return c;}});}else{dtiWrapper.generateDTIGraph("reset");}var referrerURL=document.referrer;var currentURL=window.location.href;if(referrerURL.substr(-1)!="/"){referrerURL+="/";}if(currentURL.substr(-1)!="/"){currentURL+="/";}if(referrerURL===currentURL){slideTo(500);}if(range=="Range1"){$("#dtiResults1").removeClass("hide").addClass("show-inline").attr("aria-hidden","false");$("#dtiResults2").removeClass("show-inline").addClass("hide").attr("aria-hidden","true");$("#dtiResults3").removeClass("show-inline").addClass("hide").attr("aria-hidden","true");$("#next-moneymap").removeClass("hide").addClass("show").attr("aria-hidden","false");$("#next-savings-plan").removeClass("show").addClass("hide").attr("aria-hidden","true");$("#next-compare-borrowing").removeClass("show").addClass("hide").attr("aria-hidden","true");$("#aboutDtiTool").removeClass("hide").addClass("show").attr("aria-hidden","false");$("#dti-calculation-result-one").html(roundedValue+"%");}else{if(range=="Range2"){$("#dtiResults1").removeClass("show-inline").addClass("hide").attr("aria-hidden","true");$("#dtiResults2").removeClass("hide").addClass("show-inline").attr("aria-hidden","false");$("#dtiResults3").removeClass("show-inline").addClass("hide").attr("aria-hidden","true");$("#next-moneymap").removeClass("show").addClass("hide").attr("aria-hidden","true");$("#next-savings-plan").removeClass("hide").addClass("show").attr("aria-hidden","false");$("#next-compare-borrowing").removeClass("show").addClass("hide").attr("aria-hidden","true");$("#aboutDtiTool").removeClass("hide").addClass("show").attr("aria-hidden","false");$("#dti-calculation-result-two").html(roundedValue+"%");}else{if(range=="Range3"){$("#dtiResults1").removeClass("show-inline").addClass("hide").attr("aria-hidden","true");$("#dtiResults2").removeClass("show-inline").addClass("hide").attr("aria-hidden","true");$("#dtiResults3").removeClass("hide").addClass("show-inline").attr("aria-hidden","false");$("#next-moneymap").removeClass("show").addClass("hide").attr("aria-hidden","true");$("#next-savings-plan").removeClass("show").addClass("hide").attr("aria-hidden","true");$("#next-compare-borrowing").removeClass("hide").addClass("show").attr("aria-hidden","false");$("#aboutDtiTool").removeClass("hide").addClass("show").attr("aria-hidden","false");$("#dti-calculation-result-three").html(roundedValue+"%");}}}}function showMessageBox(level,message){var levels={"error":"error","red":"error","warning":"alert","alert":"alert","yellow":"alert","info":"informational","green":"informational"};var mbox=$("#messageBox");mbox.empty();if(message instanceof Array){var ul=mbox.append("<ul></ul>");for(var i=0;i<message.length;i++){var li=document.createElement("li");$(li).append(message[i]);$("#messageBox ul").append(li);}}else{if(message.search(/\n/)!=-1){message="<p>"+message.split(/\n/).join("</p><p>")+"</p>";}mbox.append('<div class="'+level+'Headline"><span class="ui-hidden-accessible"> '+level+" </span>"+message+"</div>");if(arguments.length>2){var ul=mbox.append("<ul>");for(var i=2;i<arguments.length;i++){$(ul).append("<li>"+arguments[i]+"</li>");
}}}mbox.show({complete:function(){$(this).attr({"aria-hidden":"false","tabindex":"0"}).focus();}});}function setTotalVal(value){var totalVal;if(value!=""||value!=undefined||value!=" "){totalVal=getDebtValue();}else{totalVal=0;}var formatTotalVal=formatCurrency(totalVal,true);$("#totaldebtValue").text(formatTotalVal);}function addInputField(){$("body").on("click",".addMore",function(e){e.preventDefault?e.preventDefault():e.returnValue=false;var addMoreLinkClassName=$(this).attr("class").split(" ")[1];var debtType=$(this).parent().prev().attr("class").split(" ")[1];var payFieldName=$("."+debtType+" input:last").attr("name");var DebtTypeFieldName=payFieldName.split(".")[1];DebtTypeFieldName=DebtTypeFieldName.split("[")[0];var payFieldLastNum=payFieldName.split("[")[1];payFieldLastNum=payFieldLastNum.split("]")[0];var inptNum=parseInt(payFieldLastNum);inptNum+=1;var labelText=$("."+debtType).find("label").first().clone().children().remove().end().text();$("."+debtType).find(".liveregion").text(labelText+" "+(inptNum+1)+" edit box was added.");if($("."+debtType+" > div:visible").length<7){var additionalInputFieldLabel='<label for="'+DebtTypeFieldName+"_"+inptNum+'" class="anotherDebtLabel">'+labelText+" "+(inptNum+1)+"</label>";var addMoreField='<input name="debtCalcModel.'+DebtTypeFieldName+"["+inptNum+']"'+" "+"data-new="+inptNum+" "+'class="currency fLeft otherField" size="8" maxlength="7" type="text" id="'+DebtTypeFieldName+"_"+inptNum+'"'+" "+'pattern="[0-9]*"/>';var additionalInputField='<div class="debtAnotherField">'+additionalInputFieldLabel+'<div class="input-currency-type">$</div>'+addMoreField+' <div class="input-hide"> <a role="button" tabindex="0" class="close-icon"><img alt="'+labelText+" "+(inptNum+1)+' close" title="Input close" src="'+assetsBasePath+'/assets/images/global/ico-uti-clear-x-mob-16x16-000000-v01_00@1x.png" /></a></div></div>';$("."+debtType).append(additionalInputField);$("#"+DebtTypeFieldName+"_"+inptNum).focus();}if($("."+debtType+" > div:visible").length==7){$("."+addMoreLinkClassName).parent(".chunk").hide();}});$("body").on("keypress click","a.close-icon",function(evt){if(evt.type=="keypress"&&evt.keyCode!=13){return;}var labelText=$(this).parents(".chunk").find("label").first().clone().children().remove().end().text();var InputField=$(this).parents(".debtAnotherField").find("input.currency");var fieldValue=InputField.attr("id").split("_")[1];fieldValue=parseInt(fieldValue);$(this).parents(".chunk").find(".liveregion").text(labelText+" "+(fieldValue+1)+" edit box was removed.");$(this).parents(".debtAnotherField").nextAll().each(function(){var labelOldValue=(fieldValue+2).toString();var labelNewValue=(fieldValue+1).toString();var oldValue=(fieldValue+1).toString();var newValue=fieldValue.toString();var content=$(this).find("label").text().replace(labelOldValue,labelNewValue);$(this).find("label").text(content);$(this).children().each(function(){var attrsToChange=["for","name","id","data-new"];var $thisChild=$(this);$.each(attrsToChange,function(i,attr){if($thisChild.attr(attr)){$thisChild.attr(attr,$thisChild.attr(attr).replace(oldValue,newValue));}});});fieldValue++;});InputField.val("0");var currentVal=InputField.val();setTotalVal(currentVal);if($(this).parents(".debtAnotherField").parents(".chunk").find("> div").length<8){$(this).parents(".debtAnotherField").parents("div").next(".chunk").show();}$(this).parents(".debtAnotherField").prevAll().not(":hidden").first().find("input.currency").focus();$(this).parents(".debtAnotherField").remove();});}addInputField();function getDebtValue(){var values=0;$(".otherField").each(function(){if($(this).val()!==""){values=values+parseInt($(this).val().replace(/,/g,""),10);}});if(($("input[name=mortgageDebtList_0]").val()==""||$("input[name=mortgageDebtList_0]").val()=="0")&&($("input[name=rentDebtList_0]").val()==""||$("input[name=rentDebtList_0]").val()=="0")&&($("input[name=homeEquityDebtList_0]").val()==""||$("input[name=homeEquityDebtList_0]").val()=="0")&&($("input[name=creditCardDebtList_0]").val()==""||$("input[name=creditCardDebtList_0]").val()=="0")&&($("input[name=autoLoanDebtList_0]").val()==""||$("input[name=autoLoanDebtList_0]").val()=="0")&&($("input[name=studentLoanDebtList_0]").val()==""||$("input[name=studentLoanDebtList_0]").val()=="0")&&($("input[name=lineOfCreditDebtList_0]").val()==""||$("input[name=lineOfCreditDebtList_0]").val()=="0")&&($("input[name=otherDebtList_0]").val()==""||$("input[name=otherDebtList_0]").val()=="0")){values="0";}return values;}function totalDebt(){$("body").on("click","#c28lastFocusable",function(){$("#c28close").trigger("click");});$("body").on("click","#debtCalculatorForm .secondary.c28cancel",function(){$("#c28close").trigger("click");});}totalDebt();function escClose(){if($("#c28lightbox")){$("body").keydown(function(e){if($("#c28lightbox").css("display")=="block"){if(e.keyCode==27){$("#c28close").trigger("click");}}});}}escClose();var c2tClickEvent=function(applicationCode,logicalPageTitle,clickName,clickType){var stdOptions={"url":window.location.href,"applicationCode":applicationCode,"eventStructure[ClickCreator]":applicationCode+"_"+logicalPageTitle+"_Click","headerStructure[HeaderCreator]":"header_"+applicationCode,"data[clickType]":clickType,"data[clickItemName]":clickName};WF.Utils.logC2TtoolEvent(stdOptions);};function DTIRatioHistoryForAuthenticUser(dtiRatioHistoryJSONArray){$(".dtiRatioHistoryWrapper").removeClass("hide").addClass("show").attr("aria-hidden","false");for(var i=0;i<dtiRatioHistoryJSONArray.length;i++){var dtiDate=new Date(dtiRatioHistoryJSONArray[i].date);var dtiSaveDateFormat=(dtiDate.getMonth()+1)+"/"+dtiDate.getDate()+"/"+dtiDate.getFullYear();if(WF.Page.lang=="es"){var dtiSavedDate="<span>Se guard&oacute; en </span>"+dtiSaveDateFormat;}else{var dtiSavedDate="<span>Saved on </span>"+dtiSaveDateFormat;}$("#dtiRatioHistoryRangeWrapper").append("<div class='dtiRatioHistoryRange' data-rangeScore='"+dtiRatioHistoryJSONArray[i].dtiRatio+"' data-dtiSavedDate='"+dtiSavedDate+"'></div>");}$(".dtiRatioHistoryRange").generateDTIRange();}if(typeof isSuccess!=="undefined"&&isSuccess==="true"){var date=new Date();var formattedDate=(date.getMonth()+1)+"/"+date.getDate()+"/"+date.getFullYear();if(WF.Page.lang=="es"){$("<div id='mostRecentSavedDTIRatio'>Se guard&oacute; en <span id='mostRecentSavedDTIRatioDate'>"+formattedDate+"</span></div>").insertAfter("#dtiResults .dtiRatio h3");}else{$("<div id='mostRecentSavedDTIRatio'>Saved On <span id='mostRecentSavedDTIRatioDate'>"+formattedDate+"</span></div>").insertAfter("#dtiResults .dtiRatio h3");}}$(document).ready(function(){$(".otherCalcLink .c28aLink").click(function(){setTimeout(function(){if($(".debtMortgageFields > div:visible").length==7){$(".addMortgageField").parent(".chunk").hide();}if($(".debtRentFields > div:visible").length==7){$(".addRentField").parent(".chunk").hide();}if($(".debtHomeFields > div:visible").length==7){$(".addHomeField").parent(".chunk").hide();}if($(".debtCreditFields > div:visible").length==7){$(".addCreditField").parent(".chunk").hide();}if($(".debtAutoLoanFields > div:visible").length==7){$(".addAutoLoanField").parent(".chunk").hide();}if($(".debtStudentLoanFields > div:visible").length==7){$(".addStudentLoanField").parent(".chunk").hide();}if($(".debtlineOfCreditFields > div:visible").length==7){$(".addlineOfCreditField").parent(".chunk").hide();}if($(".debtOtherDebtFields > div:visible").length==7){$(".addOtherDebtfield").parent(".chunk").hide();}},800);});$(document).on("click","#dtiCalcResultBtn",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Calculate My DTI Ratio","BUTTON");});$(document).on("click","#dtiResults .c28bLink",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Other DTI ranges","LINK");});$(document).on("click","#next-moneymap-text .c13",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Compare Borrowing Options","LINK");});$(document).on("click","#next-savings-plan-text .c13",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Pay Off Debt Faster","LINK");
});$(document).on("click","#next-compare-borrowing-text .c13",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Lower Your Monthly Payments","LINK");});$(document).on("click","#next-savings-icon > a",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Watch Video","IMAGE");});$(document).on("click","#next-compare-icon > a",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Watch Video","IMAGE");});$(document).on("click","#nextSteps .guide-link a",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Watch Video","LINK");});$(document).on("click","#aboutDtiTool a",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Other things to consider before you borrow","LINK");});$(document).on("click",".iteMize",function(e){c2tClickEvent("DTI","SIMPLIFIED_PATH","Itemize my debt","LINK");});$(document).on("click",".addMortgageField",function(e){c2tClickEvent("DTI","GUIDED_PATH","Add mortgage payment","LINK");});$(document).on("click",".addRentField",function(e){c2tClickEvent("DTI","GUIDED_PATH","Add rent payment","LINK");});$(document).on("click",".addHomeField",function(e){c2tClickEvent("DTI","GUIDED_PATH","Add home equity payment","LINK");});$(document).on("click",".addCreditField",function(e){c2tClickEvent("DTI","GUIDED_PATH","Add credit card payment","LINK");});$(document).on("click",".addAutoLoanField",function(e){c2tClickEvent("DTI","GUIDED_PATH","Add auto loan or lease payment","LINK");});$(document).on("click",".addStudentLoanField",function(e){c2tClickEvent("DTI","GUIDED_PATH","Add student loan payment","LINK");});$(document).on("click",".addlineOfCreditField",function(e){c2tClickEvent("DTI","GUIDED_PATH","Add personal loan or line of credit payment","LINK");});$(document).on("click",".addOtherDebtfield",function(e){c2tClickEvent("DTI","GUIDED_PATH","Add other monthly debt payment","LINK");});$(document).on("click",".debtCalDone",function(e){c2tClickEvent("DTI","GUIDED_PATH","Done","BUTTON");});$(document).on("click",".btn-bottom .c28cancel",function(e){c2tClickEvent("DTI","GUIDED_PATH","Cancel","BUTTON");});$(".otherCalcLink .c28aLink").click(function(){setTimeout(function(){$("#debtCalculatorForm div:visible .otherField").each(function(){if($(this).val()!=""){var inputValue=$(this).val();inputValue=inputValue.replace(/\./g,",");$(this).val(inputValue);setTotalVal(($(this).val()));$(this).attr("maxlength","6").removeAttr("pattern");}});},600);});if(typeof isAuthenticated!=="undefined"&&isAuthenticated==="true"){if(saveDtiRatioArray&&typeof saveDtiRatioArray==="string"){var dtiRatioHistoryJSONArray=JSON.parse(saveDtiRatioArray);DTIRatioHistoryForAuthenticUser(dtiRatioHistoryJSONArray);}}});